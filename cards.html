<!doctype html><html lang="de"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self'; base-uri 'self'; form-action 'self';"><meta name="referrer" content="no-referrer"><meta name="theme-color" content="#3498db"><link rel="manifest" href="manifest.json"><link rel="dns-prefetch" href="https://cdnjs.cloudflare.com"><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin><title>Lernkarten App</title><script>function sanitizeHTML(t){var e;return"string"!=typeof t?"":((e=document.createElement("div")).textContent=t,e.innerHTML)}function sanitizeInput(t,e=1e3){if("string"!=typeof t)return"";let n=t.trim();return n=(n=n.length>e?n.substring(0,e):n).replace(/\0/g,"")}function sanitizePlayerName(t){if("string"!=typeof t)return"";let e=sanitizeHTML(t);return e=(e=sanitizeInput(e,50)).replace(/[^a-zA-Z0-9äöüÄÖÜß\s\-_\.]/g,"")}function sanitizeRoomCode(t){return"string"!=typeof t?"":t.toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,10)}function sanitizeQuestionText(t){return"string"!=typeof t?"":sanitizeInput(sanitizeHTML(t),5e3)}function sanitizeJSON(t,e=5242880){if("string"!=typeof t)return null;if(new Blob([t]).size>e)return console.error("JSON file too large"),null;try{return JSON.parse(t)}catch(t){return console.error("Invalid JSON:",t),null}}function sanitizeURL(t){if("string"==typeof t)try{var e=new URL(t);if("http:"===e.protocol||"https:"===e.protocol)return t}catch(t){}return""}function createSafeTextNode(t){return document.createTextNode(sanitizeInput(t))}function setSafeText(t,e){t&&"string"==typeof e&&(t.textContent=sanitizeInput(e))}function isValidEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}</script><style>@keyframes flyInBottom{0%{transform:translateY(50px) rotateY(0);opacity:0}to{transform:translateY(0) rotateY(0);opacity:1}}@keyframes confetti-fall{0%{transform:translateY(0) translateX(0) rotateZ(0);opacity:1}70%{opacity:1}to{transform:translateY(60vh) translateX(var(--confetti-x,0)) rotateZ(var(--confetti-rotate,720deg));opacity:0}}:root{--primary:#4a6fa5;--secondary:#166088;--light:#f8f9fa;--dark:#343a40;--success:#28a745;--danger:#dc3545;--warning:#ffc107}body{font-family:"Segoe UI",Tahoma,Geneva,Verdana,sans-serif;line-height:1.6;color:var(--dark);background-color:#f5f7fa;margin:0;padding:0;display:flex;flex-direction:column;min-height:100vh}.container{width:90%;max-width:900px;margin:1rem auto;flex:1}.header{display:flex;justify-content:space-between;align-items:center;gap:1rem;margin-bottom:0;padding:.75rem 1rem;background-color:#fff;border-radius:8px 8px 0 0;box-shadow:0 2px 4px rgba(0,0,0,.1)}.header-content{flex:1;text-align:center}.header h1{color:var(--primary);margin:.5rem 0 0;font-size:1.2rem}.header p{margin:.25rem 0;font-size:1rem}#file-input-container{margin-bottom:1rem;text-align:center}#upload-label{display:inline-block;padding:.5rem 1rem;background-color:var(--primary);color:#fff;border-radius:4px;cursor:pointer;transition:background-color .3s;margin-top:1rem}#upload-label:hover{background-color:var(--secondary)}#file-input{display:none}#saved-decks{margin:1rem 0;max-height:300px;overflow-y:auto}.saved-deck{background-color:#fff;padding:.5rem;margin-bottom:.5rem;border-radius:4px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 1px 3px rgba(0,0,0,.1)}.deck-title{font-weight:500;color:var(--primary);cursor:pointer}.delete-deck{color:var(--danger);background:0 0;border:0;cursor:pointer;font-size:1.1rem;padding:.25rem .5rem}.card,.card-container{position:relative;min-height:350px}.card-container{perspective:1000px;margin-bottom:1rem;height:calc(100vh - 280px);overflow:hidden}.card{width:100%;height:100%;text-align:center;transition:transform .8s;transform-style:preserve-3d;will-change:transform}.card.flipped{transform:rotateY(180deg)}.card.fly-in-bottom{animation:flyInBottom .6s cubic-bezier(.34,1.56,.64,1) forwards;transition:none}.card-back,.card-front{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.1);padding:1rem;box-sizing:border-box;background-color:#fff;display:flex;flex-direction:column;justify-content:space-between;top:0;left:0;transition:opacity .4s ease}.card-front{z-index:2;opacity:1;visibility:visible;pointer-events:auto}.card-back,.card.flipped .card-front{opacity:0;visibility:hidden;pointer-events:none}.card-back{transform:rotateY(180deg);z-index:1}.card.flipped .card-back{opacity:1;visibility:visible;pointer-events:auto;z-index:2}.card-content{flex:1;margin-bottom:.75rem;font-size:1.2rem;overflow-y:auto;max-height:100%}.question{font-weight:700;font-size:1.4rem;color:var(--primary);margin-bottom:.75rem}.answer{padding:.75rem;background-color:var(--light);border-left:4px solid var(--primary);margin-top:.5rem;text-align:left}.user-answer-input{width:90%;padding:.75rem;margin:1rem 0;border:1px solid #ced4da;border-radius:4px;font-size:1rem;transition:border-color .15s ease-in-out}.user-answer-input:focus{border-color:var(--primary);outline:0;box-shadow:0 0 0 .2rem rgba(74,111,165,.25)}.user-answer-display{padding:.75rem;margin-top:.5rem;background-color:#e9f2ff;border-left:4px solid #92b5e3;text-align:left;border-radius:4px}.options-container{display:flex;flex-direction:column;width:90%;margin:1rem auto;gap:.3rem}.option-item{position:relative;padding:.3rem;border:2px solid #ced4da;border-radius:6px;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;text-align:left}.option-item:hover{border-color:var(--primary);background-color:#f0f5ff}.option-item.selected{border-color:var(--primary);background-color:rgba(74,111,165,.1)}.option-item.correct{border-color:var(--success);background-color:rgba(40,167,69,.1)}.option-item.incorrect{border-color:var(--danger);background-color:rgba(220,53,69,.1)}.option-item.mc-correct-selected{background-color:#d4edda;border-color:#28a745;border-left-width:4px}.option-item.mc-correct-selected .option-checkbox{accent-color:#28a745}.option-item.mc-incorrect-selected{background-color:#f8d7da;border-color:#dc3545;border-left-width:4px}.option-item.mc-incorrect-selected .option-checkbox{accent-color:#dc3545}.option-item.mc-missed{background-color:#fff3cd;border-color:#ffc107;border-left-width:4px}.option-item.mc-missed .option-checkbox{accent-color:#ffc107}.option-item.mc-neutral{background-color:#f8f9fa;border-color:#e9ecef;opacity:.7}.option-checkbox{margin-right:.75rem;width:18px;height:18px}.selected-options-display{padding:.75rem;margin-top:.5rem;background-color:#e9f2ff;border-left:4px solid #92b5e3;text-align:left;border-radius:4px}.controls{display:flex;justify-content:space-between;flex-wrap:wrap;gap:.5rem;width:100%}.btn{padding:.4rem .8rem;border:0;border-radius:4px;cursor:pointer;font-weight:500;transition:all .3s;flex:1;min-width:80px;font-size:1rem}.btn-primary{background-color:var(--primary);color:#fff}.btn-primary:hover{background-color:var(--secondary)}.btn-success{background-color:var(--success);color:#fff}.btn-success:hover{background-color:#218838}.btn-danger{background-color:var(--danger);color:#fff}.btn-danger:hover{background-color:#c82333}.btn-secondary{background-color:#6c757d;color:#fff}.btn-secondary:hover{background-color:#5a6268}.stats{display:flex;justify-content:space-around;margin:0 0 .5rem;padding:0 0 .5rem;background-color:#fff;border-radius:0 0 8px 8px;box-shadow:0 2px 4px rgba(0,0,0,.1)}.stat-item{text-align:center}.stat-value{font-size:1.2rem;font-weight:700;color:var(--primary)}.stat-label{font-size:.9rem;color:#6c757d}.progress-bar{height:6px;background-color:#e9ecef;border-radius:4px;margin:.5rem 0;overflow:hidden}.progress{height:100%;background-color:var(--primary);width:0%}.feedback{font-size:1rem;text-align:center;margin-top:1rem;color:#6c757d}.error-message{color:var(--danger);text-align:center;margin:1rem 0}.hidden{display:none}#sample-json{margin-top:1rem;padding:.75rem;background-color:#f8f9fa;border-radius:4px;border:1px solid #dee2e6;font-family:monospace;white-space:pre-wrap;font-size:.9rem}.json-toggle{margin-top:.5rem;font-size:.9rem;color:var(--primary);cursor:pointer;text-decoration:underline}@media (max-width:600px){.container{width:95%;margin:.5rem auto}.controls{gap:.3rem}.btn{padding:.3rem .6rem;font-size:.9rem}.card,.card-container{min-height:330px}.stats{padding:.4rem .2rem}.stat-value{font-size:1.1rem}.stat-label{font-size:.9rem}}.study-mode-select{padding:.5rem .75rem;border:2px solid #ddd;border-radius:6px;font-size:.9rem;background-color:#fff;cursor:pointer;transition:border-color .3s;min-width:200px}.study-mode-select:hover{border-color:var(--primary)}.study-mode-select:focus{outline:0;border-color:var(--primary);box-shadow:0 0 0 3px rgba(52,152,219,.1)}.deck-search-container{margin-bottom:1rem}.deck-search-input{width:100%;padding:.75rem;font-size:1rem;border:2px solid #ddd;border-radius:6px;box-sizing:border-box;transition:border-color .3s}.deck-search-input:focus{outline:0;border-color:var(--primary)}#confetti-container{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;overflow:hidden;z-index:9999}.confetti-piece{position:absolute;width:12px;height:12px;will-change:transform,opacity}@media (max-width:768px){.header{flex-direction:column;align-items:stretch;gap:.75rem;padding:.75rem}.header h1{font-size:1.1rem}.header p{font-size:.9rem}.study-mode-select{width:100%;min-width:unset}}</style></head><body><div class="container"><div class="header"><div class="header-content"><h1 id="app-title">Lernkarten App</h1><p id="app-subtitle">Lade eine JSON-Datei oder ein ZIP Archiv von JSON-Dateien hoch - oder wähle ein gespeichertes Deck</p></div><select id="study-mode" class="study-mode-select"><option value="spaced-repetition">Spaced Repetition</option><option value="incorrect-first">Falsche zuerst</option><option value="incorrect-only">Nur falsche wiederholen</option></select></div><div id="file-input-container"><div class="upload-options"><div class="upload-option"><label for="file-input" id="upload-label">JSON hochladen</label> <input type="file" id="file-input" accept=".json"></div><div class="upload-option"><label for="zip-input" id="zip-upload-label">oder ZIP hochladen</label> <input type="file" id="zip-input" accept=".zip"></div></div><p><span class="json-toggle" onclick="toggleJsonSample()">JSON-Format Beispiel anzeigen</span></p><div id="sample-json" class="hidden">{ "cards": [ { "question": "Was ist die Hauptstadt von Deutschland?", "answer": "Berlin" }, { "question": "Was ist 2+2?", "answer": "4" }, { "question": "Welche sind Primzahlen?", "options": ["2", "4", "7", "9", "11"], "correct": [0, 2, 4] } ] }</div><div id="saved-decks-container"><h3>Gespeicherte Decks</h3><div class="deck-search-container"><input id="deck-search" class="deck-search-input" placeholder="🔍 Decks durchsuchen..."></div><div id="deck-selection-controls"><button id="start-selected-decks" class="btn btn-primary" disabled>Mit ausgewählten Decks starten</button> <button id="select-all-decks" class="btn btn-secondary">Alle auswählen</button> <button id="deselect-all-decks" class="btn btn-secondary">Alle abwählen</button></div><div id="saved-decks"></div></div></div><div id="app-content" class="hidden"><div class="stats"><div class="stat-item"><div class="stat-value" id="cards-remaining">0</div><div class="stat-label">Verbleibend</div></div><div class="stat-item"><div class="stat-value" id="cards-completed">0</div><div class="stat-label">Bearbeitet</div></div><div class="stat-item"><div class="stat-value" id="correct-count">0</div><div class="stat-label">Richtig</div></div><div class="stat-item"><div class="stat-value" id="incorrect-count">0</div><div class="stat-label">Falsch</div></div></div><div class="progress-bar"><div class="progress" id="progress-bar"></div></div><div class="card-container" id="card-container"><div class="card" id="flip-card"><div class="card-front"><div class="card-content"><div class="question" id="question-text">Frage erscheint hier</div><input class="user-answer-input" id="user-answer-input" placeholder="Deine Antwort..."><div id="options-container" class="options-container hidden"></div></div><div class="controls"><button class="btn btn-primary" id="show-answer">Antwort zeigen</button></div></div><div class="card-back"><div class="card-content"><div class="question" id="question-back">Frage erscheint hier</div><div class="source-deck" id="source-deck-display"></div><div id="options-container-back" class="options-container hidden"></div><div id="user-answer-container" class="hidden"><div class="user-answer-display"><strong>Deine Antwort:</strong><div id="user-answer-display"></div></div></div><div id="selected-options-container" class="hidden"><div class="selected-options-display"><strong>Deine Auswahl:</strong><div id="selected-options-display"></div></div></div><div id="standard-answer-container"><div class="answer" id="answer-text">Antwort erscheint hier</div></div><div id="mc-correct-answer-container" class="hidden"><div class="answer"><strong>Korrekte Antworten:</strong><div id="mc-correct-answer-text"></div></div></div></div><div class="controls"><button class="btn btn-success" id="mark-correct">Richtig</button> <button class="btn btn-danger" id="mark-incorrect">Falsch</button> <button class="btn btn-secondary" id="next-card">Nächste</button></div></div></div></div><div class="feedback hidden" id="feedback"><h2>Quiz abgeschlossen!</h2><div id="overall-stats"><p>Gesamtergebnis: <span id="final-score">0%</span></p></div><div id="deck-stats-container"></div><div style="margin-top:1rem"><button class="btn btn-primary" id="restart-btn">Neu starten</button> <button class="btn btn-secondary" id="upload-new-btn">Neues Deck</button></div></div><div id="error-message" class="error-message hidden"></div></div></div><div id="confetti-container"></div><script defer src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script><script defer src="cards.js"></script><script>"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").then(e=>{console.log("ServiceWorker registered:",e.scope)}).catch(e=>{console.log("ServiceWorker registration failed:",e)})})</script></body></html>